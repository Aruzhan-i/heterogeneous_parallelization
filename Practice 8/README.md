
## üìë Table of Contents

- [–ó–∞–¥–∞–Ω–∏–µ 1](#task1)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task1-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task1-terminal)
  - [–í—ã–≤–æ–¥](#task1-result)
- [–ó–∞–¥–∞–Ω–∏–µ 2](#task2)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task2-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task2-terminal)
  - [–í—ã–≤–æ–¥](#task2-result)
- [–ó–∞–¥–∞–Ω–∏–µ 3](#task3)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task3-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task3-terminal)
  - [–í—ã–≤–æ–¥](#task3-result)
- [–ó–∞–¥–∞–Ω–∏–µ 4](#task4)
  - [–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏](#task4-analysis)
- [–í—ã–≤–æ–¥—ã](#conclusions)
- [–ó–∞–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ](#task-extra)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task-extra-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task-extra-terminal)
  - [–í—ã–≤–æ–¥](#task-extra-result)
- [–ó–∞–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ 2](#task-extra2)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task-extra2-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task-extra2-terminal)
  - [–í—ã–≤–æ–¥](#task-extra2-result)
- [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã](#control-questions)

---


<a id="task1"></a>
# –ó–∞–¥–∞–Ω–∏–µ 1 

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ CPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenMP

1. –°–æ–∑–¥–∞–π—Ç–µ –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–º `N` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `N = 1 000 000`).
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ CPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
OpenMP. –ù–∞–ø—Ä–∏–º–µ—Ä, —É–º–Ω–æ–∂—å—Ç–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –Ω–∞ 2.
3. –ó–∞–º–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ CPU.

<a id="task1-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_1_block_schema.svg)

<a id="task1-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_1_terminal_output.png)

<a id="task1-result"></a>
## –í—ã–≤–æ–¥

–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã OpenMP: –ø—Ä–∏ —Ä–∞–∑–º–µ—Ä–µ –º–∞—Å—Å–∏–≤–∞ N = 1 000 000 –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—É–º–Ω–æ–∂–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ 2) –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º 16 –ø–æ—Ç–æ–∫–æ–≤. –ò–∑–º–µ—Ä–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ—Å—Ç–∞–≤–∏–ª–æ 1.1015 ms. –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞–∑–∞–ª: $A[0]=0$, $A[N-1]‚âà2¬∑10^6$, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –ø–æ—Å–ª–µ —É–º–Ω–æ–∂–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ 2.

<a id="task2"></a>
# –ó–∞–¥–∞–Ω–∏–µ 2 

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ GPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CUDA

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ GPU.
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —è–¥—Ä–æ CUDA –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ GPU. –ù–∞–ø—Ä–∏–º–µ—Ä, —É–º–Ω–æ–∂—å—Ç–µ
–∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –Ω–∞ 2.
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ CPU.
4. –ó–∞–º–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ GPU.

<a id="task2-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_2_block_schema.svg)

<a id="task2-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_2_terminal_output.png)

<a id="task2-result"></a>
## –í—ã–≤–æ–¥
–ü—Ä–∏ —Ä–∞–∑–º–µ—Ä–µ –º–∞—Å—Å–∏–≤–∞ N = 1 000 000 –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞ Block = 256, Grid = 3907 –æ–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ H2D + kernel + D2H —Å–æ—Å—Ç–∞–≤–∏–ª–æ 0.9084 ms, –∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∞–º–æ–≥–æ CUDA-—è–¥—Ä–∞ ‚Äî 0.0383 ms. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∫–∞–∑–∞–ª–∞ $out[0]=0$ –∏ $out[N‚àí1]=1 999 998$, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É —É–º–Ω–æ–∂–µ–Ω–∏—é –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ 2.



<a id="task3"></a>
# –ó–∞–¥–∞–Ω–∏–µ 3

–ì–∏–±—Ä–∏–¥–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å—Å–∏–≤–∞

1. –†–∞–∑–¥–µ–ª–∏—Ç–µ –º–∞—Å—Å–∏–≤ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: –ø–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ CPU,
–≤—Ç–æ—Ä–∞—è ‚Äî –Ω–∞ GPU.
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –≥–∏–±—Ä–∏–¥–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –º–∞—Å—Å–∏–≤–∞
–Ω–∞ CPU –∏ GPU –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
3. –ó–∞–º–µ—Ä—å—Ç–µ –æ–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≥–∏–±—Ä–∏–¥–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

<a id="task3-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_3_block_schema.svg)

<a id="task3-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_3_terminal_output.png)

<a id="task3-result"></a>
## –í—ã–≤–æ–¥
–ì–∏–±—Ä–∏–¥–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å—Å–∏–≤–∞: –º–∞—Å—Å–∏–≤ N = 1 000 000 –±—ã–ª —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: –ø–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ (500 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞—Å—å –Ω–∞ CPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenMP (16 –ø–æ—Ç–æ–∫–æ–≤), –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ (500 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤) ‚Äî –Ω–∞ GPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CUDA. GPU —á–∞—Å—Ç—å –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º stream (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ H2D ‚Üí kernel ‚Üí –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ D2H), –ø–æ–∫–∞ CPU –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª —Å–≤–æ—é –ø–æ–ª–æ–≤–∏–Ω—É. –û–±—â–µ–µ –≤—Ä–µ–º—è –≥–∏–±—Ä–∏–¥–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (wall time) —Å–æ—Å—Ç–∞–≤–∏–ª–æ 1.3787 ms. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: $out[0]=0$, $out[N‚àí1]=1 999 998$ (—É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 2).

| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è   | –ß—Ç–æ –∑–∞–º–µ—Ä—è–ª–æ—Å—å                               | –í—Ä–µ–º—è, ms |
| ------------ | -------------------------------------------- | --------: |
| CPU (OpenMP) | –æ–±—Ä–∞–±–æ—Ç–∫–∞ N –Ω–∞ CPU                           |    1.1015 |
| GPU (CUDA)   | H2D + kernel + D2H                           |    0.9084 |
| Hybrid       | CPU half + GPU half –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (wall time) |    1.3787 |


<a id="task4"></a>
# –ó–∞–¥–∞–Ω–∏–µ 4

–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. –°—Ä–∞–≤–Ω–∏—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ CPU, GPU –∏ –≤ –≥–∏–±—Ä–∏–¥–Ω–æ–º
—Ä–µ–∂–∏–º–µ.
2. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –≤ –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö
–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –≤—ã–∏–≥—Ä—ã—à.

<a id="task4-analysis"></a>
## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏


## 1) –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ CPU / GPU / Hybrid

| –†–µ–∂–∏–º                                         | –ß—Ç–æ –∏–∑–º–µ—Ä—è–ª–∏                             | –í—Ä–µ–º—è (ms) |      –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ CPU (—É—Å–∫–æ—Ä–µ–Ω–∏–µ) |
| --------------------------------------------- | ---------------------------------------- | ---------: | --------------------------------: |
| **CPU (OpenMP, 16 threads)**                  | –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ–≥–æ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ CPU           | **1.1015** |                         **1.00√ó** |
| **GPU (CUDA)**                                | **H2D + kernel + D2H** –¥–ª—è –≤—Å–µ–≥–æ –º–∞—Å—Å–∏–≤–∞ | **0.9084** |                 **1.21√ó –±—ã—Å—Ç—Ä–µ–µ** |
| **GPU (CUDA)**                                | **—Ç–æ–ª—å–∫–æ kernel**                        | **0.0383** | (–ø–æ—á—Ç–∏ –≤—Å—ë –≤—Ä–µ–º—è ‚Äî –Ω–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è) |
| **Hybrid (CPU half + GPU half –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)** | wall time (–æ–±—â–µ–µ –≤—Ä–µ–º—è)                  | **1.3787** |         **0.80√ó** (–º–µ–¥–ª–µ–Ω–Ω–µ–µ CPU) |

**–í—ã–≤–æ–¥ –ø–æ —Ü–∏—Ñ—Ä–∞–º:** –≤ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ (–æ—á–µ–Ω—å –ª—ë–≥–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è `*2`) **–ª—É—á—à–µ –≤—Å–µ–≥–æ** –æ–∫–∞–∑–∞–ª—Å—è **GPU total**, CPU —á—É—Ç—å —Ö—É–∂–µ, –∞ **hybrid –æ–∫–∞–∑–∞–ª—Å—è —Ö—É–∂–µ**, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –∑–∞–º–µ—Ç–Ω–µ–µ, —á–µ–º –≤—ã–≥–æ–¥–∞ –æ—Ç ‚Äú–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏‚Äù.



## 2) –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –ø–æ—á–µ–º—É —Ç–∞–∫ –≤—ã—à–ª–æ

### –ü–æ—á–µ–º—É GPU total –±—ã—Å—Ç—Ä–µ–µ CPU –≤ —Ç–≤–æ—ë–º —Å–ª—É—á–∞–µ

* GPU –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∞–º—É –æ–ø–µ—Ä–∞—Ü–∏—é: **kernel 0.0383 ms**.
* –ü–æ—á—Ç–∏ –≤—Å—ë –≤—Ä–µ–º—è —É—Ö–æ–¥–∏—Ç –Ω–µ –Ω–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –∞ –Ω–∞ **–ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö**:
  `0.9084 ‚àí 0.0383 = 0.8701 ms` ‚Üí —ç—Ç–æ H2D + D2H.

–¢–æ –µ—Å—Ç—å GPU –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –¥–∞–∂–µ —Å –∫–æ–ø–∏—è–º–∏ ‚Äî –Ω–æ –≤—ã–∏–≥—Ä—ã—à –Ω–µ–±–æ–ª—å—à–æ–π (**~1.21√ó**), –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–∞–¥–∞—á–∞ —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è.

### –ü–æ—á–µ–º—É hybrid –æ–∫–∞–∑–∞–ª—Å—è –º–µ–¥–ª–µ–Ω–Ω–µ–µ

–ì–∏–±—Ä–∏–¥–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏–º–µ—Ä–Ω–æ:
$T_{hybrid} \approx \max(T_{CPU(half)},; T_{GPU(half; pipeline)}) + overhead$

–ì–¥–µ **overhead** ‚Äî —ç—Ç–æ:

* –∑–∞–ø—É—Å–∫ stream + async –∫–æ–ø–∏–∏ + —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è `cudaStreamSynchronize`,
* —Ä–∞–±–æ—Ç–∞ OpenMP (—Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞),
* –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ ‚Äú—Å—Ç—ã–∫–æ–≤–∫–∏‚Äù CPU‚ÜîGPU.

–î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ `*2` –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –º–∞–ª–æ, –ø–æ—ç—Ç–æ–º—É **overhead –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç**, –∏ –≥–∏–±—Ä–∏–¥ –Ω–µ –æ–∫—É–ø–∞–µ—Ç—Å—è.



## 3) –ö–æ–≥–¥–∞ hybrid –¥–∞—ë—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –≤—ã–∏–≥—Ä—ã—à (–≥–ª–∞–≤–Ω—ã–π –ø—É–Ω–∫—Ç)

–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—ã–≥–æ–¥–Ω—ã–º, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ª–æ–≤–∏—è:

1. **–ë–æ–ª—å—à–∞—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç**
   –ù–µ ‚Äú–æ–¥–Ω–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ‚Äù, –∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Å–≤—ë—Ä—Ç–∫–∏, –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, sin/cos, —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞, ML-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å –∏ —Ç.–¥.
   –¢–æ–≥–¥–∞ GPU —Ä–µ–∞–ª—å–Ω–æ ‚Äú–∑–∞–±–∏—Ä–∞–µ—Ç‚Äù —Ç—è–∂—ë–ª—É—é —á–∞—Å—Ç—å, –∏ –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ, —á–µ–º overhead.

2. **–ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏ (overlap)**
   Hybrid –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à, –∫–æ–≥–¥–∞:

   * GPU —Å—á–∏—Ç–∞–µ—Ç –æ–¥–Ω—É —á–∞—Å—Ç—å,
   * CPU —Å—á–∏—Ç–∞–µ—Ç –¥—Ä—É–≥—É—é,
   * –∏ –ø—Ä–∏ —ç—Ç–æ–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–¥—ë—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º.

3. **–î–∞–Ω–Ω—ã–µ —É–∂–µ –Ω–∞ GPU –∏–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ**
   –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–∞ GPU (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ), —Å—Ç–æ–∏–º–æ—Å—Ç—å H2D/D2H ‚Äú—Ä–∞–∑–º–∞–∑—ã–≤–∞–µ—Ç—Å—è‚Äù, –∏ hybrid (–∏ –≤–æ–æ–±—â–µ GPU) –≤—ã–∏–≥—Ä—ã–≤–∞—é—Ç —Å–∏–ª—å–Ω–µ–µ.

4. **–ù–∞–≥—Ä—É–∑–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –¥–µ–ª–∏—Ç—Å—è**
   –ù–∞–ø—Ä–∏–º–µ—Ä: —Ä–∞–∑–Ω—ã–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–∑–Ω—ã–µ —ç—Ç–∞–ø—ã –ø–∞–π–ø–ª–∞–π–Ω–∞, —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π (CPU ‚Äî –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞/–≤–µ—Ç–≤–ª–µ–Ω–∏—è, GPU ‚Äî –ø–ª–æ—Ç–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞).



## 4) –ö–æ—Ä–æ—Ç–∫–∏–π –≤—ã–≤–æ–¥ (–¥–ª—è –æ—Ç—á—ë—Ç–∞)

–í —Ç–µ–∫—É—â–µ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—è `A[i] *= 2` —è–≤–ª—è–µ—Ç—Å—è ‚Äúmemory-bound‚Äù –∏ —Å–ª–∏—à–∫–æ–º –ª—ë–≥–∫–æ–π –ø–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º, –ø–æ—ç—Ç–æ–º—É —Å–∫–æ—Ä–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –Ω–∞–∫–ª–∞–¥–Ω—ã–º–∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏ –Ω–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—É—Å–∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. GPU –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –ø–æ–ª–Ω–æ–º—É —Ü–∏–∫–ª—É, –æ–¥–Ω–∞–∫–æ –≥–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –∏–∑-–∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é CPU –∏ GPU. –ù–∞–∏–±–æ–ª—å—à–∏–π –≤—ã–∏–≥—Ä—ã—à –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–∞—ë—Ç –≤ –∑–∞–¥–∞—á–∞—Ö —Å –≤—ã—Å–æ–∫–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å—é –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏ (pipeline/overlap), –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ GPU –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ.


<a id="conclusions"></a>
# –í—ã–≤–æ–¥—ã 

### 1) **–í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω?**

–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (CPU + GPU –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ) —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, –∫–æ–≥–¥–∞ –∑–∞–¥–∞—á–∞:

* **–≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ —Ç—è–∂—ë–ª–∞—è** (–Ω–∞ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –º–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π, –∞ –Ω–µ 1 —É–º–Ω–æ–∂–µ–Ω–∏–µ);
* **—Ö–æ—Ä–æ—à–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—Å—è** –∏ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —á–∞—Å—Ç–∏ –±–µ–∑ –≤–∑–∞–∏–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π;
* –ø–æ–∑–≤–æ–ª—è–µ—Ç **–≤—ã–ø–æ–ª–Ω—è—Ç—å CPU –∏ GPU —Ä–∞–±–æ—Ç—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**, –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö;
* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ **–º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ**, —á—Ç–æ–±—ã –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ H2D/D2H –Ω–µ –±—ã–ª–æ –≥–ª–∞–≤–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø–æ—Ç–µ—Ä—å;
* —Å–æ–¥–µ—Ä–∂–∏—Ç —ç—Ç–∞–ø—ã, –≥–¥–µ **CPU –ª—É—á—à–µ** (–ª–æ–≥–∏–∫–∞, –≤–µ—Ç–≤–ª–µ–Ω–∏—è, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö), –∞ **GPU –ª—É—á—à–µ** (–º–∞—Å—Å–æ–≤–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞).

üëâ –í –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Ç–∏–ø–∞ `A[i] *= 2` –≥–∏–±—Ä–∏–¥ —á–∞—Å—Ç–æ –Ω–µ –¥–∞—ë—Ç –≤—ã–∏–≥—Ä—ã—à, –ø–æ—Ç–æ–º—É —á—Ç–æ overhead (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è) –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ–ª—å–∑—É.

---

### 2) **–ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π?**

–ù–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –≤–ª–∏—è—é—Ç:

* **–û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö** (—á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º –≤—ã—à–µ —Ü–µ–Ω–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É CPU –∏ GPU)
* **–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å** (—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ 1 —ç–ª–µ–º–µ–Ω—Ç)
* **–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã GPU**: –∑–∞–ø—É—Å–∫ kernel, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ stream
* **–°–∫–æ—Ä–æ—Å—Ç—å –ø–∞–º—è—Ç–∏ –∏ –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**:

  * RAM (CPU)
  * VRAM (GPU)
  * PCIe (–º–µ–∂–¥—É CPU –∏ GPU)
* **–ë–∞–ª–∞–Ω—Å –Ω–∞–≥—Ä—É–∑–∫–∏** (–µ—Å–ª–∏ CPU –¥–µ–ª–∞–µ—Ç –¥–æ–ª—å—à–µ ‚Äî GPU –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç)
* **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ CPU (OpenMP)** –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è workload
* **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏** (`cudaMemcpyAsync`, streams)
* **–¢–∏–ø –ø–∞–º—è—Ç–∏**: pinned/pageable (pinned –æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç overlap)

---

### 3) **–ö–∞–∫ –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É CPU –∏ GPU?**

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö ‚Äî –∫–ª—é—á –∫ —É—Å–∫–æ—Ä–µ–Ω–∏—é –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º:

‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Pinned memory** (`cudaMallocHost`)
  ‚Üí –±—ã—Å—Ç—Ä–µ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ–∑–º–æ–∂–Ω–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–ø–∏–∏**:

  * `cudaMemcpyAsync`
  * –∏ `cudaStream` –¥–ª—è overlap
* **–ü–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å (overlap)**: –ø–æ–∫–∞ GPU —Å—á–∏—Ç–∞–µ—Ç ‚Äî CPU –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç/–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥—Ä—É–≥—É—é —á–∞—Å—Ç—å
* –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ **–±–∞—Ç—á–∞–º–∏ (chunks)**, –∞ –Ω–µ –æ–¥–Ω–∏–º –±–æ–ª—å—à–∏–º –º–∞—Å—Å–∏–≤–æ–º (pipeline)
* –£–º–µ–Ω—å—à–∞—Ç—å —á–∏—Å–ª–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π:

  * –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ —Ç–æ, —á—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ
  * –æ—Å—Ç–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ GPU –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Unified Memory** (`cudaMallocManaged`) –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö (—É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –±—ã—Å—Ç—Ä–µ–µ)
* –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä transfer:

  * –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —á–∞—Å—Ç–∏
  * —Å–∂–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ/–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω—å—à–∏–π —Ç–∏–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä `half`, `uint16` –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)

<a id="control-questions"></a>
# –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

## 1) –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –≥–∏–±—Ä–∏–¥–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è?

–ì–∏–±—Ä–∏–¥–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã CPU –∏ GPU –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**, —á—Ç–æ –¥–∞—ë—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

* **—É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** –∑–∞ —Å—á—ë—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã CPU –∏ GPU;
* **–ª—É—á—à–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** —Å–∏—Å—Ç–µ–º—ã (CPU –Ω–µ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç –ø–æ–∫–∞ GPU —Å—á–∏—Ç–∞–µ—Ç –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç);
* –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∑–∞–¥–∞—á**: CPU ‚Äî –ª–æ–≥–∏–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, GPU ‚Äî –º–∞—Å—Å–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è;
* —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Å—á—ë—Ç –≤—ã—Å–æ–∫–æ–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏ GPU;
* –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **–ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è** (overlap), –ø–æ–≤—ã—à–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

---

## 2) –ö–∞–∫ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É CPU –∏ GPU?

–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç—Å—è –∑–∞ —Å—á—ë—Ç:

* **—Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —á–∏—Å–ª–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π** (–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ);
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è **Pinned memory (page-locked)** (`cudaMallocHost`) ‚Üí –±—ã—Å—Ç—Ä–µ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ;
* –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∫–æ–ø–∏–π** `cudaMemcpyAsync`;
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è **CUDA streams**, —á—Ç–æ–±—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è;
* —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞–Ω–∫–∏ (**pipeline**), —á—Ç–æ–±—ã –ø–æ–∫–∞ –æ–¥–∏–Ω –±–ª–æ–∫ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è ‚Äî –¥—Ä—É–≥–æ–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è;
* –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ GPU (–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–∞ CPU –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏).

---

## 3) –ö–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –ª—É—á—à–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞ CPU, –∞ –∫–∞–∫–∏–µ ‚Äî –Ω–∞ GPU?

### ‚úÖ –õ—É—á—à–µ –Ω–∞ CPU:

* –∑–∞–¥–∞—á–∏ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º **–≤–µ—Ç–≤–ª–µ–Ω–∏–π** (if/else), —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏;
* –æ–ø–µ—Ä–∞—Ü–∏–∏, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –∏ –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ GPU;
* —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–æ–π, –≤–≤–æ–¥/–≤—ã–≤–æ–¥, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á;
* –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –ø–ª–æ—Ö–æ –ø–∞—Ä–∞–ª–ª–µ–ª—è—â–∏–µ—Å—è.

### ‚úÖ –õ—É—á—à–µ –Ω–∞ GPU:

* –º–∞—Å—Å–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞–¥ –±–æ–ª—å—à–∏–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ (**SIMD / data-parallel**);
* –ª–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞: –º–∞—Ç—Ä–∏—Ü—ã, –≤–µ–∫—Ç–æ—Ä—ã, —Å–≤—ë—Ä—Ç–∫–∏;
* –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, CNN;
* –∑–∞–¥–∞—á–∏ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö.

---

## 4) –ö–∞–∫ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —É–ª—É—á—à–∞–µ—Ç—Å—è –∑–∞ —Å—á—ë—Ç:

* **–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –Ω–∞–≥—Ä—É–∑–∫–∏** –º–µ–∂–¥—É CPU –∏ GPU (—á—Ç–æ–±—ã –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–ª);
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π + streams**, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å transfer –∏ compute;
* –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è **pinned memory**;
* —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (chunking, fewer transfers);
* ‚Äú–ø—Ä–æ–≥—Ä–µ–≤–∞‚Äù GPU (warm-up kernel), —á—Ç–æ–±—ã –∑–∞–º–µ—Ä—ã –∏ —Ä–∞–±–æ—Ç–∞ –±—ã–ª–∏ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ;
* –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ GPU-—è–¥—Ä–∞:

  * –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `block/grid`,
  * coalesced memory access,
  * –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ª–∏—à–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.


<a id="task-extra"></a>
# –ó–∞–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –º–∞—Å—Å–∏–≤–∞, –≥–¥–µ –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å –º–∞—Å—Å–∏–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
—Ä–∞–∑–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ CPU –∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ GPU).

<a id="task-extra-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_extra_block_schema.svg)

<a id="task-extra-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_extra_terminal_output.png)


<a id="task-extra-result"></a>
## –í—ã–≤–æ–¥ 
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ (—Ä–∞–∑–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ CPU –∏ GPU): –º–∞—Å—Å–∏–≤ N = 1 000 000 –±—ã–ª —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ –¥–≤–µ —Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–∏. –ü–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞—Å—å –Ω–∞ CPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenMP (–æ–ø–µ—Ä–∞—Ü–∏—è A[i] = A[i] + 5), –∞ –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ ‚Äî –Ω–∞ GPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CUDA (–æ–ø–µ—Ä–∞—Ü–∏—è A[i] = A[i] * 2). GPU-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ stream (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ H2D ‚Üí kernel ‚Üí –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ D2H), –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ CPU –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–ª —Å–≤–æ—é —á–∞—Å—Ç—å. –û–±—â–µ–µ –≤—Ä–µ–º—è –≥–∏–±—Ä–∏–¥–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (wall time) —Å–æ—Å—Ç–∞–≤–∏–ª–æ 2.1296 ms. –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: out[0]=5, out[half]=1 000 000, out[N‚àí1]=1 999 998.




<a id="task-extra2"></a>
# –ó–∞–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ 2
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –º–∞—Å—Å–∏–≤–∞, –≥–¥–µ –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å –º–∞—Å—Å–∏–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
—Ä–∞–∑–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ CPU –∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ GPU).

<a id="task-extra2-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_extra_block_schema.svg)

<a id="task-extra2-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_extra_terminal_output.png)


<a id="task-extra2-result"></a>
## –í—ã–≤–æ–¥ 

‚úÖ –í—ã–≤–æ–¥ 1 (CPU vs GPU)

–í compute-heavy —Ä–µ–∂–∏–º–µ (ITERS=256) GPU –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å CPU(OpenMP): —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 65√ó‚Äì96√ó –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞ N. –≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π —Å—Ç–µ–ø–µ–Ω—å—é –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ GPU –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

‚úÖ –í—ã–≤–æ–¥ 2 (Hybrid —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)

–ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º (CPU+GPU –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–Ω–æ 1.6√ó‚Äì2.0√ó –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ CPU. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ GPU –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —Å–Ω–∏–∂–∞—è –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ CPU –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ –≤–¥–≤–æ–µ.

‚úÖ –í—ã–≤–æ–¥ 3 (–∫–æ–≥–¥–∞ hybrid ‚Äú–ª—É—á—à–∏–π‚Äù)

–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –≤ —É—Å–ª–æ–≤–∏—è—Ö:

–≤—ã—Å–æ–∫–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç (compute-heavy),

–±–æ–ª—å—à–æ–≥–æ –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö,

–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã CPU –∏ GPU (streams + OpenMP),

–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É CPU –∏ GPU.