## üìë Table of Contents

- [–ó–∞–¥–∞–Ω–∏–µ 1](#task1)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task1-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task1-terminal)
  - [–í—ã–≤–æ–¥](#task1-result)
- [–ó–∞–¥–∞–Ω–∏–µ 2](#task2)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task2-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task2-terminal)
  - [–í—ã–≤–æ–¥](#task2-result)
- [–ó–∞–¥–∞–Ω–∏–µ 3](#task3)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task3-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task3-terminal)
  - [–í—ã–≤–æ–¥](#task3-result)
- [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã](#control-questions)

---

<a id="task1"></a>
# –ó–∞–¥–∞–Ω–∏–µ 1 


–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ CPU-–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (OpenMP)

–†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ C++ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenMP –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
–±–æ–ª—å—à–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã, —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏
–¥–∏—Å–ø–µ—Ä—Å–∏–∏).

–¢—Ä–µ–±—É–µ—Ç—Å—è:
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é;
- –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º omp_get_wtime() –∏/–∏–ª–∏
–ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∞ (Intel VTune, gprof);
- –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å:
    - –¥–æ–ª—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã;
    - –≤–ª–∏—è–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ;
    - –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∑–∞–∫–æ–Ω–∞ –ê–º–¥–∞–ª–∞

<a id="task1-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_1_block_schema.svg)

<a id="task1-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_1_terminal_output_.png)

<a id="task1-result"></a>
## –í—ã–≤–æ–¥

| Threads (T) | init (s) | sum (s) | var (s) | total (s) |
| ----------: | -------: | ------: | ------: | --------: |
|           1 |    0.236 |   0.025 |   0.033 |     0.294 |
|           2 |    0.237 |   0.015 |   0.017 |     0.269 |
|           4 |    0.234 |   0.012 |   0.010 |     0.256 |
|           8 |    0.233 |   0.013 |   0.009 |     0.255 |


|  T | total (s) | Speedup | Efficiency |
| -: | --------: | ------: | ---------: |
|  1 |     0.294 |   1.000 |      1.000 |
|  2 |     0.269 |   1.093 |      0.546 |
|  4 |     0.256 |   1.148 |      0.287 |
|  8 |     0.255 |   1.153 |      0.144 |

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ OpenMP –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∏ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç ~1.15√ó –ø—Ä–∏ 8 –ø–æ—Ç–æ–∫–∞—Ö. –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤—ã—Å–æ–∫–æ–π –¥–æ–ª–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç–∏: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ 80% –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (S‚âà0.80). –°–æ–≥–ª–∞—Å–Ω–æ –∑–∞–∫–æ–Ω—É –ê–º–¥–∞–ª–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —á–∏—Å–ª–µ –ø–æ—Ç–æ–∫–æ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 1/S‚âà1.25√ó, —á—Ç–æ —Å–æ–≥–ª–∞—Å—É–µ—Ç—Å—è —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –ü—Ä–∏ —ç—Ç–æ–º –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å (sum+variance) –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ (—É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ ~2.6√ó –Ω–∞ 4‚Äì8 –ø–æ—Ç–æ–∫–∞—Ö), –æ–¥–Ω–∞–∫–æ –µ—ë –≤–∫–ª–∞–¥ –≤ –æ–±—â–µ–µ –≤—Ä–µ–º—è –º–∞–ª, –ø–æ—ç—Ç–æ–º—É –∏—Ç–æ–≥–æ–≤–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤—Å–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∏–º.




<a id="task2"></a>
# –ó–∞–¥–∞–Ω–∏–µ 2

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏ –Ω–∞ GPU (CUDA)

–†–µ–∞–ª–∏–∑—É–π—Ç–µ —è–¥—Ä–æ CUDA –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞ –¥–∞–Ω–Ω—ã—Ö, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–µ–µ —Ä–∞–∑–Ω—ã–µ
–ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏.
–¢—Ä–µ–±—É–µ—Ç—Å—è:
1. —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–≤–µ –≤–µ—Ä—Å–∏–∏ —è–¥—Ä–∞:
    a. —Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º (–∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º) –¥–æ—Å—Ç—É–ø–æ–º –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏;
    b. —Å –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –ø–∞–º—è—Ç–∏;
2. –∏–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º cudaEvent;
3. –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∑–∞ —Å—á—ë—Ç:
    a. –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏;
    b. –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤;
4. —Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥—ã –æ –≤–ª–∏—è–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏ –Ω–∞
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å GPU.


<a id="task2-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_2_block_schema.svg)

<a id="task2-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_2_terminal_output_.png)

<a id="task2-result"></a>
## –í—ã–≤–æ–¥


| –í–µ—Ä—Å–∏—è                            | –ü–∞—Ç—Ç–µ—Ä–Ω –¥–æ—Å—Ç—É–ø–∞                                                        |  –í—Ä–µ–º—è (ms) |
| --------------------------------- | ---------------------------------------------------------------------- | ----------: |
| Coalesced (baseline)              | —á—Ç–µ–Ω–∏–µ `in[tid]`, –∑–∞–ø–∏—Å—å `out[tid]` (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)                  |  **3.2937** |
| Gather non-coalesced (stride 32)  | —á—Ç–µ–Ω–∏–µ `in[(tid*32)&(N-1)]` (—Ä–∞–∑–±—Ä–æ—Å–∞–Ω–æ), –∑–∞–ø–∏—Å—å `out[tid]`            | **13.1311** |
| Gather non-coalesced (stride 128) | —á—Ç–µ–Ω–∏–µ `in[(tid*128)&(N-1)]` (–µ—â—ë —Ö—É–∂–µ), –∑–∞–ø–∏—Å—å `out[tid]`             | **14.9530** |
| Shared tile+permute (stride 32)   | **–∫–æ–∞–ª–µ—Å—Ü. –∑–∞–≥—Ä—É–∑–∫–∞ –≤ shared**, –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ shared, –∫–æ–∞–ª–µ—Å—Ü. –∑–∞–ø–∏—Å—å |  **3.0383** |
| Coalesced grid-stride             | –∫–æ–∞–ª–µ—Å—Ü., –Ω–æ grid-stride loop                                          |  **3.2150** |



| –í–µ—Ä—Å–∏—è                | –í—Ä–µ–º—è (ms) |       –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ baseline |
| --------------------- | ---------: | --------------------------: |
| Coalesced             |     3.2937 |                       1.00√ó |
| Gather stride 32      |    13.1311 |         **3.99√ó –º–µ–¥–ª–µ–Ω–Ω–µ–µ** |
| Gather stride 128     |    14.9530 |         **4.54√ó –º–µ–¥–ª–µ–Ω–Ω–µ–µ** |
| Shared tile+permute   |     3.0383 | **0.92√ó (‚âà 1.08√ó –±—ã—Å—Ç—Ä–µ–µ)** |
| Grid-stride coalesced |     3.2150 |    **0.98√ó (–ø–æ—á—Ç–∏ —Ç–∞–∫ –∂–µ)** |



–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω –¥–æ—Å—Ç—É–ø–∞ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å CUDA-—è–¥—Ä–∞. –ö–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, –ø–æ—ç—Ç–æ–º—É baseline –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ ~3.29 ms. –ü—Ä–∏ –Ω–µ–∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º gather-–¥–æ—Å—Ç—É–ø–µ –≤—Ä–µ–º—è –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç –¥–æ 13‚Äì15 ms (–≤ ~4‚Äì4.5 —Ä–∞–∑–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ), —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ä–æ—Å—Ç–æ–º —á–∏—Å–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ —É—Ö—É–¥—à–µ–Ω–∏–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–µ—à–∞. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ shared memory –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ ‚Äú–Ω–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–π‚Äù –¥–æ—Å—Ç—É–ø –≤–Ω—É—Ç—Ä—å shared, —á—Ç–æ –ø–æ—á—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —à—Ç—Ä–∞—Ñ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –∫ —É—Ä–æ–≤–Ω—é baseline (~3.04 ms). –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤ (grid-stride) –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–µ –¥–∞—ë—Ç –±–æ–ª—å—à–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –ø–∞–º—è—Ç–∏ –ø—Ä–∏ —É–∂–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º –∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ.







<a id="task3"></a>
# –ó–∞–¥–∞–Ω–∏–µ 3

–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è CPU + GPU

–†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≥–∏–±—Ä–∏–¥–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —á–∞—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ CPU, –∞
—á–∞—Å—Ç—å ‚Äî –Ω–∞ GPU.
–¢—Ä–µ–±—É–µ—Ç—Å—è:
1. —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞ –¥–∞–Ω–Ω—ã—Ö;
2. –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö (cudaMemcpyAsync) –∏ CUDA streams;
3. –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
    a. –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö;
    b. –≤—ã—è–≤–∏—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ CPU –∏ GPU;
4. –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é, —É–º–µ–Ω—å—à–∞—é—â—É—é –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã.

<a id="task3-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_3_block_schema.svg)

<a id="task3-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_3_terminal_output_.png)

<a id="task3-result"></a>
## –í—ã–≤–æ–¥

–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ, —á—Ç–æ GPU-—á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –Ω–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏, –∞ –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö: –ø—Ä–∏ N=67,108,864 –¥–æ–ª—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ H2D+D2H —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç ~92.9% GPU-–ø–∞–π–ø–ª–∞–π–Ω–∞, —Ç–æ–≥–¥–∞ –∫–∞–∫ —è–¥—Ä–æ –∑–∞–Ω–∏–º–∞–µ—Ç ~7.1%. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å CPU‚ÜîGPU –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (PCIe). –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pinned memory –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É, –∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ CUDA streams –∏ event-based –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π; –æ–¥–Ω–∞–∫–æ –ø—Ä–∏ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ–º kernel —ç—Ñ—Ñ–µ–∫—Ç overlap –æ–≥—Ä–∞–Ω–∏—á–µ–Ω. –î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –æ–¥–Ω—É –ø–µ—Ä–µ–¥–∞—á—É (–∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è) –ª–∏–±–æ —Å–æ–∫—Ä–∞—â–∞—Ç—å —á–∏—Å–ª–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π/–æ—Å—Ç–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ GPU –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏.



<a id="task4"></a>
# –ó–∞–¥–∞–Ω–∏–µ 4

–ê–Ω–∞–ª–∏–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (MPI)

–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ MPI –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–¥
–±–æ–ª—å—à–∏–º –º–∞—Å—Å–∏–≤–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—É–º–º–∞, –º–∏–Ω–∏–º—É–º, –º–∞–∫—Å–∏–º—É–º).
–¢—Ä–µ–±—É–µ—Ç—Å—è:
- –∏–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω–æ–º —á–∏—Å–ª–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤;
- –æ—Ü–µ–Ω–∏—Ç—å strong scaling –∏ weak scaling;
- –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (MPI_Reduce,
MPI_Allreduce);
- —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥ –æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏ –µ–≥–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö.

<a id="task4-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_4_block_schema.svg)

<a id="task4-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_4_terminal_output_.png)

<a id="task4-result"></a>
## –í—ã–≤–æ–¥

|  P | total_max (s) | compute_max (s) | comm_max (s) | Speedup = T1/Tp | Efficiency = Speedup/P | –î–æ–ª—è comm = comm/total |
| -: | ------------: | --------------: | -----------: | --------------: | ---------------------: | ---------------------: |
|  1 |      0.085721 |        0.085700 |     0.000020 |           1.000 |                  1.000 |                  0.02% |
|  2 |      0.043207 |        0.042901 |     0.000420 |           1.984 |                  0.992 |                  0.97% |
|  4 |      0.022821 |        0.022628 |     0.000177 |           3.756 |                  0.939 |                  0.78% |
|  8 |      0.012747 |        0.011667 |     0.004711 |           6.725 |                  0.841 |             **36.96%** |
| 16 |      0.013686 |        0.010321 |     0.002630 |           6.263 |                  0.391 |             **19.22%** |



–ü—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º N_global=100,000,000 –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ö–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –¥–æ 4 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –±–ª–∏–∑–∫–æ –∫ –ª–∏–Ω–µ–π–Ω–æ–º—É (Speedup‚âà3.76 –ø—Ä–∏ P=4), –∞ –¥–æ–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 1% –≤—Ä–µ–º–µ–Ω–∏. –ù–∞—á–∏–Ω–∞—è —Å P=8 –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã MPI_Reduce —Ä–µ–∑–∫–æ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—Ç (comm‚âà37% total), –∏–∑-–∑–∞ —á–µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç –∏ —Ä–æ—Å—Ç —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è. –ü—Ä–∏ P=16 –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —É—Ö—É–¥—à–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ P=8, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–¥–µ–ª strong scaling –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–¥–∞—á–∏: –ª–æ–∫–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–∏—à–∫–æ–º –º–∞–ª, –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏/—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç.


|  P |      N_global | compute_max (s) | comm_max (s) | total_max (s) | E_weak = T1/Tp | –î–æ–ª—è comm = comm/total |
| -: | ------------: | --------------: | -----------: | ------------: | -------------: | ---------------------: |
|  1 |   100,000,000 |        0.086571 |     0.000037 |      0.086609 |          1.000 |                  0.04% |
|  2 |   200,000,000 |        0.086513 |     0.000023 |      0.086644 |          1.000 |                  0.03% |
|  4 |   400,000,000 |        0.090010 |     0.000270 |      0.090200 |          0.960 |                  0.30% |
|  8 |   800,000,000 |        0.090943 |     0.016497 |      0.091234 |          0.949 |             **18.08%** |
| 16 | 1,600,000,000 |        0.122888 |     0.050896 |      0.136743 |      **0.633** |             **37.22%** |


–î–ª—è strong scaling (N_global=100 –º–ª–Ω) –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –±–ª–∏–∑–∫–æ–µ –∫ –ª–∏–Ω–µ–π–Ω–æ–º—É —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ 4 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤; –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –¥–æ 8 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–æ–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –∑–∞–º–µ—Ç–Ω–æ —Ä–∞—Å—Ç—ë—Ç, –∞ –ø—Ä–∏ 16 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–∞–ª—å–Ω–µ–π—à–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑-–∑–∞ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π. –î–ª—è weak scaling (N_local=100 –º–ª–Ω –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å) –≤—Ä–µ–º—è –ø–æ—á—Ç–∏ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –¥–æ 4 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ö–æ—Ä–æ—à–µ–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –ø—Ä–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å. –û–¥–Ω–∞–∫–æ –ø—Ä–∏ 8 –∏ –æ—Å–æ–±–µ–Ω–Ω–æ 16 –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö —Ä–µ–∑–∫–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π MPI_Reduce (–¥–æ ~18% –∏ ~37% –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏), –∞ —Ç–∞–∫–∂–µ —Ä–∞—Å—Ç—ë—Ç compute_max, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–ª–ª–µ–∫—Ç–∏–≤–æ–≤, —Å–µ—Ç–µ–≤—É—é/–º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω—É—é –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –∑–∞ —Ä–µ—Å—É—Ä—Å—ã. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º–∏; –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö P —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –æ–±—ä—ë–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ —Å–æ–∫—Ä–∞—â–∞—Ç—å —á–∏—Å–ª–æ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–∞–≥—Ä–µ–≥–∞—Ü–∏—è, —Ä–µ–∂–µ –≤—ã–∑—ã–≤–∞—Ç—å reduce, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ —Å—Ö–µ–º—ã).