
## üìë Table of Contents

- [–ó–∞–¥–∞–Ω–∏–µ 1](#task1)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task1-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task1-terminal)
  - [–í—ã–≤–æ–¥](#task1-result)
- [–ó–∞–¥–∞–Ω–∏–µ 2](#task2)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task2-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task2-terminal)
  - [–í—ã–≤–æ–¥](#task2-result)
- [–ó–∞–¥–∞–Ω–∏–µ 3](#task3)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task3-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task3-terminal)
  - [–í—ã–≤–æ–¥](#task3-result)
- [–ó–∞–¥–∞–Ω–∏–µ 4](#task4)
  - [–ë–ª–æ–∫ —Å—Ö–µ–º–∞](#task4-block)
  - [–í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞](#task4-terminal)
  - [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã](#task4-desc)
  - [–ú–µ—Ç–æ–¥–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π](#task4-method)
  - [–í—ã–≤–æ–¥](#task4-result)
- [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã](#control-questions)

---

<a id="task1"></a>
# –ó–∞–¥–∞–Ω–∏–µ 1 

–†–µ–∞–ª–∏–∑—É–π—Ç–µ CUDA-–ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—É–º–º—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞ —Å
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å
–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–∞ CPU –¥–ª—è –º–∞—Å—Å–∏–≤–∞ —Ä–∞–∑–º–µ—Ä–æ–º 100 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

<a id="task1-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_1_block_schema.svg)

<a id="task1-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_1_terminal_output.png)

<a id="task1-result"></a>
## –í—ã–≤–æ–¥

1. **GPU –ø–æ–∫–∞–∑–∞–ª —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –¥–∞–∂–µ –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–º –º–∞—Å—Å–∏–≤–µ (100K —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
2. **–¢–æ—á–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤—ã—Å–æ–∫–∞—è** - –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –º–µ–Ω–µ–µ 0.001% –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
3. **–ü—Ä–∏—á–∏–Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è:** 
   - –ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö CPU‚ÜîGPU —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã —Å –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
   - –î–ª—è –º–∞—Å—Å–∏–≤–æ–≤ 100K —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π ~1–º—Å —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ
   - GPU —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö (>1–ú —ç–ª–µ–º–µ–Ω—Ç–æ–≤)

4. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:**
   - –ì–ª–æ–±–∞–ª—å–Ω—É—é –ø–∞–º—è—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
   - Shared memory –¥–ª—è —Ä–µ–¥—É–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é tree-based —Ä–µ–¥—É–∫—Ü–∏—é –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ GPU —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å CPU-–≤–µ—Ä—Å–∏–µ–π —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é.


<a id="task2"></a>
# –ó–∞–¥–∞–Ω–∏–µ 2


–†–µ–∞–ª–∏–∑—É–π—Ç–µ CUDA-–ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è) –º–∞—Å—Å–∏–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏. –°—Ä–∞–≤–Ω–∏—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–∞ CPU –¥–ª—è –º–∞—Å—Å–∏–≤–∞ —Ä–∞–∑–º–µ—Ä–æ–º 1 000 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

<a id="task2-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_2_block_schema.svg)

<a id="task2-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_2_terminal_output.png)

<a id="task2-result"></a>
## –í—ã–≤–æ–¥

–í —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ CUDA-–ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã (prefix sum, inclusive scan) –º–∞—Å—Å–∏–≤–∞ —Ä–∞–∑–º–µ—Ä–æ–º 1 000 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏. –ê–ª–≥–æ—Ä–∏—Ç–º –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—É–º–º –±–ª–æ–∫–æ–≤ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏–π –∫ –∫–∞–∂–¥–æ–º—É –±–ª–æ–∫—É.

–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ GPU-–≤–µ—Ä—Å–∏–∏ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–∞ CPU. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞—é—Ç, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ —Å–æ—Å—Ç–∞–≤–∏–ª–∞ 0 %, —á—Ç–æ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞.

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞–ª–æ, —á—Ç–æ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ CPU –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è. –≠—Ç–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ –Ω–∞–∫–ª–∞–¥–Ω—ã–º–∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π CUDA-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç—å—é –∏ –≤–∏–¥–µ–æ–ø–∞–º—è—Ç—å—é, –∞ —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–æ–º CUDA-—è–¥–µ—Ä. –ü—Ä–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–º –æ–±—ä—ë–º–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –ø—Ä–µ–≤—ã—à–∞—é—Ç –≤—ã–∏–≥—Ä—ã—à –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã —è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏. –û–¥–Ω–∞–∫–æ –µ—ë –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–∞–º–µ—Ç–Ω–æ–π –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á, –≥–¥–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º GPU –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã.





<a id="task3"></a>
# –ó–∞–¥–∞–Ω–∏–µ 3

–†–µ–∞–ª–∏–∑—É–π—Ç–µ –≥–∏–±—Ä–∏–¥–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å—Å–∏–≤–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–∞ CPU –∏ GPU. –ü–µ—Ä–≤—É—é —á–∞—Å—Ç—å –º–∞—Å—Å–∏–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞ CPU, –≤—Ç–æ—Ä—É—é ‚Äî –Ω–∞
GPU. –°—Ä–∞–≤–Ω–∏—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è CPU-, GPU- –∏ –≥–∏–±—Ä–∏–¥–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π.

<a id="task3-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_3_block_schema.svg)

<a id="task3-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_3_terminal_output.png)

<a id="task3-result"></a>
## –í—ã–≤–æ–¥

–í —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–∏–±—Ä–∏–¥–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –º–∞—Å—Å–∏–≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–∞ CPU –∏ GPU: –ø–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞ –≤—ã—á–∏—Å–ª—è–ª–∞—Å—å –Ω–∞ CPU, –≤—Ç–æ—Ä–∞—è ‚Äî –Ω–∞ GPU. –í –∫–∞—á–µ—Å—Ç–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã (inclusive scan). –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –ø–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω—ã –Ω–∞ GPU –∫ –µ—ë —ç–ª–µ–º–µ–Ω—Ç–∞–º –¥–æ–±–∞–≤–ª—è–ª–æ—Å—å —Å–º–µ—â–µ–Ω–∏–µ, —Ä–∞–≤–Ω–æ–µ —Å—É–º–º–µ –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–π –Ω–∞ CPU.

–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ CPU-only, GPU-only –∏ Hybrid: –∏—Ç–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç, —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–æ–∫ ‚Äî **OK**.

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ 1 000 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤) –ø–æ–∫–∞–∑–∞–ª–æ:

* **CPU-only:** 1.1270 ms
* **GPU-only:** 19.9729 ms
* **Hybrid:** 2.0718 ms

–ì–∏–±—Ä–∏–¥–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–∫–∞–∑–∞–ª–∞—Å—å –±—ã—Å—Ç—Ä–µ–µ GPU-only, —Ç–∞–∫ –∫–∞–∫ —á–∞—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ CPU, –∞ –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ GPU —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è. –û–¥–Ω–∞–∫–æ CPU-only –æ—Å—Ç–∞—ë—Ç—Å—è —Å–∞–º—ã–º –±—ã—Å—Ç—Ä—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞ –∏–∑-–∑–∞ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ GPU, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—É—Å–∫–æ–º CUDA-—è–¥–µ—Ä. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É CPU –∏ GPU, –æ–¥–Ω–∞–∫–æ –Ω–∞ –º–∞—Å—Å–∏–≤–µ 1 000 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ GPU –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –æ–≤–µ—Ä—Ö–µ–¥–æ–º.




# –ó–∞–¥–∞–Ω–∏–µ 3

–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MPI –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞
–¥–∞–Ω–Ω—ã—Ö. –†–∞–∑–¥–µ–ª–∏—Ç–µ –º–∞—Å—Å–∏–≤ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ –∏
—Å–æ–±–µ—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∑–∞–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è 2, 4 –∏ 8 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

<a id="task4-block"></a>
## –ë–ª–æ–∫ —Å—Ö–µ–º–∞

![alt text](task_4_block_schema.svg)

<a id="task4-terminal"></a>
## –í—ã–≤–æ–¥ –¢–µ—Ä–º–∏–Ω–∞–ª–∞
![alt text](task_4_terminal_output.png)

<a id="task4-result"></a>
## –í—ã–≤–æ–¥


–í –∑–∞–¥–∞–Ω–∏–∏ –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å—Å–∏–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MPI. –ú–∞—Å—Å–∏–≤ –¥–µ–ª–∏–ª—Å—è –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (MPI_Scatterv), –∑–∞—Ç–µ–º –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω—è–ª –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–π —Å—É–º–º—ã (inclusive scan). –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã—á–∏—Å–ª—è–ª–æ—Å—å —á–µ—Ä–µ–∑ MPI_Exscan (—Å—É–º–º–∞ –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤), –ø–æ—Å–ª–µ —á–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–±–∏—Ä–∞–ª–∏—Å—å –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–µ 0 (MPI_Gatherv). –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π (Correctness: OK).

–ó–∞–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è 2, 4 –∏ 8 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ–∫–∞–∑–∞–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ —Ä–æ—Å—Ç–µ —á–∏—Å–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: 4.345 ms (2 –ø—Ä–æ—Ü–µ—Å—Å–∞), 6.105 ms (4 –ø—Ä–æ—Ü–µ—Å—Å–∞), 10.268 ms (8 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤). –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ä–æ—Å—Ç–æ–º –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é (Scatter/Gather/Exscan), –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏ —Ä–∞–∑–º–µ—Ä–µ –º–∞—Å—Å–∏–≤–∞ 1 000 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ, —á–µ–º –≤—ã–∏–≥—Ä—ã—à –æ—Ç —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, MPI-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –æ–¥–Ω–∞–∫–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∫ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º: –ø—Ä–∏ –º–∞–ª—ã—Ö/—Å—Ä–µ–¥–Ω–∏—Ö –æ–±—ä—ë–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç.


<a id="control-questions"></a>
# –û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã


## 1) –í —á—ë–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –æ—Ç–ª–∏—á–∏–µ –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –æ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ –Ω–∞ CPU –∏–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ GPU?

**CPU-only** ‚Äî –≤—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ. –ü–ª—é—Å—ã: –ø—Ä–æ—Å—Ç–æ—Ç–∞, –º–∞–ª—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã, –±—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö –∑–∞–¥–∞—á–∞—Ö.
**GPU-only** ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ GPU (—è–¥—Ä–∞ CUDA/OpenCL). –ü–ª—é—Å—ã: –≤—ã—Å–æ–∫–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –µ—Å—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—É—Å–∫ —è–¥–µ—Ä.
**Hybrid (CPU+GPU)** ‚Äî –∑–∞–¥–∞—á–∞ **—Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è** –º–µ–∂–¥—É CPU –∏ GPU: —á–∞—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–µ–ª–∞–µ—Ç CPU, —á–∞—Å—Ç—å ‚Äî GPU, —á–∞—Å—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞,
* —É–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞ —Å—á—ë—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞,
* –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, CPU ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö, GPU ‚Äî –º–∞—Å—Å–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è).

---

## 2) –î–ª—è –∫–∞–∫–∏—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–µ–∂–¥—É CPU –∏ GPU?

–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–µ–Ω –¥–ª—è –∑–∞–¥–∞—á, –≥–¥–µ:

* –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ **—Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —á–∞—Å—Ç–∏** (chunking),
* –µ—Å—Ç—å **—Ç—è–∂—ë–ª—ã–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è** –¥–ª—è GPU,
* –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞ CPU (–ª–æ–≥–∏–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, IO).

–ü—Ä–∏–º–µ—Ä—ã:

* –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å—Å–∏–≤–æ–≤/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Å–≤—ë—Ä—Ç–∫–∏),
* –ª–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞ (—É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü),
* –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (Monte Carlo),
* –∑–∞–¥–∞—á–∏ ML (–∏–Ω—Ñ–µ—Ä–µ–Ω—Å/–æ–±—É—á–µ–Ω–∏–µ),
* –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, —Ä–µ–¥—É–∫—Ü–∏–∏ (–ø—Ä–∏ –±–æ–ª—å—à–æ–º —Ä–∞–∑–º–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö).

---

## 3) –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É CPU –∏ GPU?

**–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ (blocking)** ‚Äî CPU –∂–¥—ë—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
–ü—Ä–∏–º–µ—Ä: `cudaMemcpy()`.

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ (non-blocking)** ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ CPU –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.
–ü—Ä–∏–º–µ—Ä: `cudaMemcpyAsync()` + CUDA streams.

–ì–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ: —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ **–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç **–ø–µ—Ä–µ–∫—Ä—ã—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã–º–∏ —Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏**.

---

## 4) –ü–æ—á–µ–º—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã?

–ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* **—Å–∫—Ä—ã—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö** (latency hiding),
* –≤—ã–ø–æ–ª–Ω—è—Ç—å **–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** (overlap),
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pipeline (–ø–æ–∫–∞ GPU —Å—á–∏—Ç–∞–µ—Ç –±–ª–æ–∫ i, CPU –∫–æ–ø–∏—Ä—É–µ—Ç –±–ª–æ–∫ i+1).

–≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –∫–æ–≥–¥–∞:

* –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–ª–æ–∫–∞–º–∏,
* –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è pinned memory (page-locked host memory),
* –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω—ã CUDA streams.

---

## 5) –ö–∞–∫–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ MPI –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏?

–û—Å–Ω–æ–≤–Ω—ã–µ MPI-—Ñ—É–Ω–∫—Ü–∏–∏:

* `MPI_Init`, `MPI_Finalize` ‚Äî –∑–∞–ø—É—Å–∫ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ MPI-–ø—Ä–æ–≥—Ä–∞–º–º—ã
* `MPI_Comm_rank` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–º–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ (rank)
* `MPI_Comm_size` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
* **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**

  * `MPI_Scatter` ‚Äî —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞–∑–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
  * `MPI_Scatterv` ‚Äî —Ä–∞–∑–¥–∞—Ç—å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ —á–∞—Å—Ç–∏ (–∫–∞–∫ –≤ —Ç–≤–æ—ë–º –∑–∞–¥–∞–Ω–∏–∏)
* **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:**

  * `MPI_Gather` ‚Äî —Å–æ–±—Ä–∞—Ç—å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
  * `MPI_Gatherv` ‚Äî —Å–æ–±—Ä–∞—Ç—å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
* **–û–±–º–µ–Ω/—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**

  * `MPI_Barrier` ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
  * `MPI_Bcast` ‚Äî —Ä–∞—Å—Å—ã–ª–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ–º
* **–ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**

  * `MPI_Reduce`, `MPI_Allreduce` ‚Äî —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ/–º–∞–∫—Å–∏–º—É–º –∏ —Ç.–¥.
  * `MPI_Scan`, `MPI_Exscan` ‚Äî –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã (–æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –¥–ª—è prefix sum –∑–∞–¥–∞—á)

---

## 6) –ö–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ MPI –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –ø–æ—á–µ–º—É?

–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –±–æ–ª—å—à–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚Üí –±–æ–ª—å—à–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ ‚Üí –º–µ–Ω—å—à–µ –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
–ù–æ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –≤—Ä–µ–º—è –º–æ–∂–µ—Ç:

* —É–º–µ–Ω—å—à–∞—Ç—å—Å—è –¥–æ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ —á–∏—Å–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤,
* –ø–æ—Ç–æ–º –ø–µ—Ä–µ—Å—Ç–∞—Ç—å —É–º–µ–Ω—å—à–∞—Ç—å—Å—è,
* –∏–ª–∏ –¥–∞–∂–µ —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è.

–ü—Ä–∏—á–∏–Ω–∞: –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Ä–∞—Å—Ç—É—Ç **–Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏**:

* Scatter/Gather,
* –ø–µ—Ä–µ—Å—ã–ª–∫–∏,
* —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (`MPI_Barrier`),
* –∑–∞–¥–µ—Ä–∂–∫–∏ —Å–µ—Ç–∏/—à–∏–Ω—ã.

–í —Ç–≤–æ–∏—Ö –∑–∞–º–µ—Ä–∞—Ö (2‚Üí4‚Üí8) –≤—Ä–µ–º—è —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–∞–¥–∞—á–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ª—ë–≥–∫–∞—è, –∞ –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–ª –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å.

---

## 7) –ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º?

–û—Å–Ω–æ–≤–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

1. **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ (network / IPC)**

   * latency –∏ bandwidth
2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**

   * –æ–∂–∏–¥–∞–Ω–∏–µ —Å–∞–º—ã—Ö –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (‚Äú—ç—Ñ—Ñ–µ–∫—Ç —Ö–≤–æ—Å—Ç–∞‚Äù)
3. **–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (load imbalance)**

   * –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ª–∞–µ—Ç –±–æ–ª—å—à–µ —Ä–∞–±–æ—Ç—ã ‚Üí –≤—Å–µ –∂–¥—É—Ç
4. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞**

   * –∑–∞–∫–æ–Ω –ê–º–¥–∞–ª–∞: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç—å—é
5. **–û–≤–µ—Ä—Ö–µ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

   * —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
6. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ –∫–µ—à–µ–π**

   * –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã —É–∑–ª–æ–≤

---

## 8) –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –æ–ø—Ä–∞–≤–¥–∞–Ω–æ, –∞ –≤ –∫–∞–∫–∏—Ö ‚Äî –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ?

### ‚úÖ –û–ø—Ä–∞–≤–¥–∞–Ω–æ, –µ—Å–ª–∏:

* –¥–∞–Ω–Ω—ã–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ (–º–∏–ª–ª–∏–∞—Ä–¥—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã),
* –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ç—è–∂—ë–ª—ã–µ –∏ **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–∞—é—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏**,
* –Ω—É–∂–Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –æ–¥–Ω–æ–π –º–∞—à–∏–Ω—ã,
* —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ/HPC.

### ‚ùå –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –µ—Å–ª–∏:

* –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö –Ω–µ–±–æ–ª—å—à–æ–π/—Å—Ä–µ–¥–Ω–∏–π,
* –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ª—ë–≥–∫–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è),
* —Ç—Ä–µ–±—É–µ—Ç—Å—è —á–∞—Å—Ç—ã–π –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏,
* –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏/—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–Ω–∏–º–∞—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —á–µ–º —Å–∞–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
  (–∫–∞–∫ –≤ —Ç–≤–æ—ë–º MPI-–∑–∞–º–µ—Ä–µ –Ω–∞ 1 000 000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤).

